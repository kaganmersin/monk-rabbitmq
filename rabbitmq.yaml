namespace: rabbitmq


rabbitmq:
  defines: runnable
  containers:
    defines: containers
    rabbitmq:
      image: rabbitmq
      image-tag: <- `${rabbitmq-image}`
      ports:
        - 4369:4369
        - 5551:5551
        - 5552:5552
        - 5672:5672
        - 25672:25672
        - 8081:15672
      paths:
        - <- `${monk-volume-path}/rabbitmq:/var/lib/rabbitmq/`
  files:
    advanced-config:
      container: rabbitmq
      mode: 0644
      path: /etc/rabbitmq/advanced.config
      contents: <<< files/advanced.config
    config:
      container: rabbitmq
      mode: 0644
      path: /etc/rabbitmq/rabbitmq.conf
      contents: <<< files/rabbitmq.conf
  variables:
    rabbitmq-image:
      value: <- $rabbitmq-image-tag
      type: string     
    RABBITMQ_MNESIA_BASE:
      env: RABBITMQ_MNESIA_BASE
      type: string
      value: "/var/lib/rabbitmq/mnesia/"
    RABBITMQ_CONFIG_FILE:
      env: RABBITMQ_CONFIG_FILE
      type: string
      value: "/etc/rabbitmq/rabbitmq.conf"
    RABBITMQ_ADVANCED_CONFIG_FILE:
      env: RABBITMQ_ADVANCED_CONFIG_FILE
      type: string
      value: "/etc/rabbitmq/advanced.config"